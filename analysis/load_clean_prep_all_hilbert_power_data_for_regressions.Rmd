---
title: "Load And Clean Newly Preprocessed Power Data"
author: "Brooke Staveland"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo <- FALSE,  # don't print the code chunk
  warning <- FALSE,  # don't print warnings
  message <- FALSE,  # don't print messages
  fig.width <- 12,  # set default width of figures
  fig.height <- 6,  # set default height of figures
  fig.align <- "center",  # always align figure in center
  fig.pos <- "H",  # always plot figure at the exact location of the code chunk
  cache <- TRUE)  # cache results

## libraries ##
library(tidyverse)
library(ggplot2)
library(magrittr)
# library(ggthemr)
library(grid)
library(gtable)
library(gridExtra)
library(wesanderson)
library(ggsci)
library(zoo)
library(kableExtra)
library(lme4)
library(RColorBrewer)
library(doParallel)
library(parallel)
library(foreach)
library(here)
library(fs)
library(ggcorrplot)
library(viridis)
library(beepr)
library(lmtest)

## hand written functions ##
source(path(here(), "R", "load_behave_data.R"))
source(path(here(), "R", "prep_behave_data.R"))
source(path(here(), "R", "stretch_start_end.R"))
source(path(here(), "R", "load_high_gamma_data.R"))
source(path(here(), "R", "rolling_window_and_baseline.R"))
source(path(here(), "R", "run_permuted_regressions.R"))
source(path(here(), "R", "compile_results.R"))
source(path(here(), "R", "run_filtered_anova.R"))
source(path(here(), "R", "merge_stepped_anova_results.R"))
source(path(here(), "R", 'mutate_cond.R'))

## plotting helpers ##
# ggthemr("solarized")

# ## paralellization ##
# nCores <- 2
# registerDoParallel(nCores)

```


This script is loads, cleans, and merges the high frequency activity for both presentation-locked and choice-locked data. The results are csvs ready for input to the regression analysis.

```{r behave-prep}

# path to beahvioral files #
path_to_raw_behave <- fs::path(here(), "../dg_behave_formatted")
path_to_behave_munge <- fs::path(here(), "munge", "combined_behavioral_data.csv")
path_to_behave_clean <- fs::path(here(), "munge", "clean_behavioral_data.csv")

# concactenate behavioral data #
load_behave_data(path_to_raw_behave)

# prep behavioral data #
prep_behave_data(path_to_behave_munge)

# load clean data #
behave_data <- read.csv(path_to_behave_clean)

# filter to current subject #
behave_data_19 <- behave_data %>% filter(SID == "DG_s08")
behave_data_35 <- behave_data %>% filter(SID == "DG_s11")
behave_data_28 <- behave_data %>% filter(SID == "DG_s10")
behave_data_39 <- behave_data %>% filter(SID == "DG_s12")
behave_data_16 <- behave_data %>% filter(SID == "DG_s06")
behave_data_10 <- behave_data %>% filter(SID == "DG_s04")
behave_data_57 <- behave_data %>% filter(SID == "DG_s13")

# table(behave_data$ineq_advent_choice)
# table(behave_data_08$ineq_disadvent_choice)
# table(behave_data_11$ineq_disadvent_choice)
# table(behave_data_12$ineq_disadvent_choice)
```

```{r behavioral-correlations}

plot_behave_cors <- function(df){
  
  behave_correl_data <- df %>%
    select(self_payoff, other_payoff, self_var_payoff, other_var_payoff, other_foregone, self_foregone, self_diff, other_diff, ineq_advent, ineq_disadvent)
  
  behavioral_cor <- cor(behave_correl_data, use = "pairwise.complete.obs")
  
  ggcorrplot(behavioral_cor,
             lab = T,
             type = "lower",
             colors = wes_palette("Zissou1", 3, type = "continuous"))
}

```

```{r behave-sim}

subjects_payoff <- behave_data %>%
  select(SID, round, self_payoff) %>%
  spread(key = SID, value = self_payoff) %>%
  arrange(round) %>%
  select(-round, -DG_s05, -DG_s14)

percent_of_subjects_with_same_answers <-  apply(subjects_payoff, 1, function(x) max(summary(as.factor(x)))/12)

subjects_payoff$percent_same <- percent_of_subjects_with_same_answers
subjects_payoff$round <- 1:228

percent_same_df <- subjects_payoff %>% select(round, percent_same)

behave_data <- merge.data.frame(behave_data, percent_same_df, by = "round")

good_subs <- subjects_payoff[percent_of_subjects_with_same_answers > .7, ]

subject_corpartial <- cor(good_subs, use = "pairwise.complete.obs")
subject_cor <- cor(subjects_payoff, use = "pairwise.complete.obs")
  
ggcorrplot(subject_cor,
             lab = T,
             type = "lower",
             colors = wes_palette("Zissou1", 3, type = "continuous"))
 

ggcorrplot(subject_corpartial,
             lab = T,
             type = "lower",
             colors = wes_palette("Zissou1", 3, type = "continuous"))
  
```


```{r compare}
rounds_to_use <- c(1:228)[percent_of_subjects_with_same_answers > .7]  


compare <- behave_data %>%
  select(SID, round, self_payoff, self_foregone, other_payoff, other_foregone) %>%
  filter(SID %in% c("DG_s08", "DG_s11")) %>%
  arrange(round)

compare %>%
  gather(key = "predictors", value = "Amount", -SID, -round) %>%
  ggplot(., aes(x = round, y = Amount, color = SID)) +
  geom_point() + 
  geom_line() +
  theme(panel.background = element_rect(fill = "white")) +
  facet_wrap(~predictors)

compare %>%
  filter(round %in% rounds_to_use) %>%
  gather(key = "predictors", value = "Amount", -SID, -round) %>%
  ggplot(., aes(x = round, y = Amount, color = SID)) +
  geom_point() + 
  geom_line() +
  theme(panel.background = element_rect(fill = "white")) +
  facet_wrap(~predictors)

```


## Presentation

```{r load-hg-data-presentation-locked-35, eval=F}

### IR35 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR35_presentation_data <- function(file_path_to_power_data, clean_name) {

  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR35_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR35_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR35.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 250, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_35, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
    hg_behave <- hg_behave %>% filter(!is.na(RT))
  # write it #
  write.csv(hg_behave, clean_name)

}

## Extract for all f ##
# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR35_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR35_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR35_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR35_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR35_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR35_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-presentation-locked-19, eval = F}

### IR19 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR19_presentation_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR19_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR19_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_19, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR19.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 200, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_19, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}

# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR19_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR19_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR19_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR19_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR19_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR19_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-presentation-locked-57, eval = F}

### IR57 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR57_presentation_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR57_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR57_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_57, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR57.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 200, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_57, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}

# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR57_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR57_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR57_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR57_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR57_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR57_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-presentation-locked-39, eval = F}

### IR39 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR39_presentation_data <- function(file_path_to_power_data, clean_name) {

  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR39_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR39_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR39.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 200, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_39, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR39_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR39_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR39_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR39_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR39_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR39_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-presentation-locked-16, eval = F}

### IR16 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR16_presentation_data <- function(file_path_to_power_data, clean_name) {

  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR16_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR16_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_16, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))

  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR16.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 200, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_16, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR16_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR16_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR16_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR16_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR16_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR16_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-presentation-locked-10, eval = F}

### IR10 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR10_presentation_data <- function(file_path_to_power_data, clean_name) {

  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR10_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR10_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR10.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 200, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_10, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR10_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR10_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR10_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR10_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR10_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR10_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-presentation-locked-28, eval = F}

### IR28 ~ PRESENTATION ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR28_presentation_data <- function(file_path_to_power_data, clean_name) {

  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR28_electrodes_presentation_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR28_elecs_of_interest.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # save baseline #
  baseline_data <- hg_data[, 1:200]
  baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
  write.csv(baseline_data, path(here(), "munge", "baseline_IR28.csv"))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, lWin = 200, lOver = 50, choice_locked = F)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_28, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_delta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "delta_behave_presentation_rscaler_2575_200.csv")
load_IR28_presentation_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_theta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "theta_behave_presentation_rscaler_2575_200.csv")
load_IR28_presentation_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_alpha_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "alpha_behave_presentation_rscaler_2575_200.csv")
load_IR28_presentation_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_beta_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "beta_behave_presentation_rscaler_2575_200.csv")
load_IR28_presentation_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_gamma_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "gamma_behave_presentation_rscaler_2575_200.csv")
load_IR28_presentation_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_hfa_munge_presentation_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "hfa_behave_presentation_rscaler_2575_200.csv")
load_IR28_presentation_data(file_path_to_power_data, clean_name)

beep(2)
```


## Choice 

```{r load-hg-data-choice-locked-35, eval = F}

### IR35 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR35_choice_data <- function(file_path_to_power_data, clean_name) {
    
    # necessary paths #
    file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR35_electrodes_choice_locked_rscaler_2575.csv")
    file_path_to_elecs_of_interest <- path(here(), "munge", "IR35_elecs_of_interest.csv")
    file_path_to_baseline <- path(here(), "munge", "baseline_IR35.csv")
    
    # load data #
    hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
    elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
    
    # filter to good electrodes #
    hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
    
    # save baseline #
    baseline_data <- hg_data[, 1:200]
    baseline_data <- cbind(baseline_data, hg_data$electrodes, hg_data$trial)
    
    # average and baseline #
    hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
    
    # with behavior #
    hg_behave <- merge.data.frame(hg_clean, behave_data_35, by.x = "trial", by.y = "round", all.x = T, all.y = F)
    # clean any missing RTs #
    hg_behave <- hg_behave %>% filter(!is.na(RT))
    # save it #
    write.csv(hg_behave, clean_name)
}

# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "delta_behave_choice_rscaler_2575_200.csv")
load_IR35_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "theta_behave_choice_rscaler_2575_200.csv")
load_IR35_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR35_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "beta_behave_choice_rscaler_2575_200.csv")
load_IR35_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR35_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR35_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR35", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR35_choice_data(file_path_to_power_data, clean_name)


beep(2)
```

```{r load-hg-data-choice-locked-19, eval = F}


### IR19 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR19_choice_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR19_electrodes_choice_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR19_elecs_of_interest.csv")
  file_path_to_baseline <- path(here(), "munge", "baseline_IR19.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_19, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_19, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "delta_behave_choice_rscaler_2575_200.csv")
load_IR19_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "theta_behave_choice_rscaler_2575_200.csv")
load_IR19_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR19_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "beta_behave_choice_rscaler_2575_200.csv")
load_IR19_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR19_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR19_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR19", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR19_choice_data(file_path_to_power_data, clean_name)


```

```{r load-hg-data-choice-locked-39, eval = F}


### IR39 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR39_choice_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR39_electrodes_choice_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR39_elecs_of_interest.csv")
  file_path_to_baseline <- path(here(), "munge", "baseline_IR39.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_39, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_39, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "delta_behave_choice_rscaler_2575_200.csv")
load_IR39_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "theta_behave_choice_rscaler_2575_200.csv")
load_IR39_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR39_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "beta_behave_choice_rscaler_2575_200.csv")
load_IR39_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR39_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR39_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR39", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR39_choice_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-choice-locked-16, eval = F}

### IR16 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR16_choice_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR16_electrodes_choice_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR16_elecs_of_interest.csv")
  file_path_to_baseline <- path(here(), "munge", "baseline_IR16.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_16, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # remove trials that were missing in baseline data #
  hg_data <- hg_data %>% filter(!trial %in% c(74, 95))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_16, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "delta_behave_choice_rscaler_2575_200.csv")
load_IR16_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "theta_behave_choice_rscaler_2575_200.csv")
load_IR16_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR16_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "beta_behave_choice_rscaler_2575_200.csv")
load_IR16_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR16_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR16_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR16", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR16_choice_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-choice-locked-57}

### IR57 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR57_choice_data <- function(file_path_to_power_data, clean_name) {
    
    # necessary paths #
    file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR57_electrodes_choice_locked_rscaler_2575.csv")
    file_path_to_elecs_of_interest <- path(here(), "munge", "IR57_elecs_of_interest.csv")
    file_path_to_baseline <- path(here(), "munge", "baseline_IR57.csv")
    
    # load data #
    hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
    elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
    
    # filter to good electrodes #
    hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
    
    # add behavioral data, remove bad trials, remove behavioral data again #
    hg_data <- merge.data.frame(hg_data, behave_data_57, by.x = "trial", by.y = "round", all.x = T, all.y = F)
    hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
    hg_data <- hg_data %>% filter(trial != 105) # not in baseline data for some reason

    # average and baseline #
    hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
    
    # with behavior #
    hg_behave <- merge.data.frame(hg_clean, behave_data_57, by.x = "trial", by.y = "round", all.x = T, all.y = F)
    # clean any missing RTs #
    hg_behave <- hg_behave %>% filter(!is.na(RT))
    # save it #
    write.csv(hg_behave, clean_name)
}

# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "delta_behave_choice_rscaler_2575_200.csv")
load_IR57_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "theta_behave_choice_rscaler_2575_200.csv")
load_IR57_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR57_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "beta_behave_choice_rscaler_2575_200.csv")
load_IR57_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR57_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR57_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR57", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR57_choice_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-choice-locked-10}


### IR10 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR10_choice_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR10_electrodes_choice_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR10_elecs_of_interest.csv")
  file_path_to_baseline <- path(here(), "munge", "baseline_IR10.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_10, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_10, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "delta_behave_choice_rscaler_2575_200.csv")
load_IR10_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "theta_behave_choice_rscaler_2575_200.csv")
load_IR10_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR10_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "beta_behave_choice_rscaler_2575_200.csv")
load_IR10_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR10_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR10_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR10", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR10_choice_data(file_path_to_power_data, clean_name)

beep(2)
```

```{r load-hg-data-choice-locked-28}


### IR28 ~ CHOICE ###

## function to filter to ROI, baseline, compress, and c=merge within behvaioral data ##
load_IR28_choice_data <- function(file_path_to_power_data, clean_name) {
  # necessary paths #
  file_path_to_electrode_names <- path(here(), "munge", "savio_cluster", "IR28_electrodes_choice_locked_rscaler_2575.csv")
  file_path_to_elecs_of_interest <- path(here(), "munge", "IR28_elecs_of_interest.csv")
  file_path_to_baseline <- path(here(), "munge", "baseline_IR28.csv")
  
  # load data #
  hg_data <- load_high_gamma_data(file_path_to_power_data, file_path_to_electrode_names)
  elecs_to_use <- read.csv(file_path_to_elecs_of_interest)
  
  # add behavioral data, remove bad trials, remove behavioral data again #
  hg_data <- merge.data.frame(hg_data, behave_data_28, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  hg_data <- hg_data %>% filter(!is.na(RT)) %>% select(trial, electrodes, starts_with("time"))
  
  # filter to good electrodes #
  hg_data <- hg_data %>% filter(grepl(paste(elecs_to_use$Electrode, collapse = "|"), electrodes))
  
  # average and baseline #
  hg_clean <- rolling_window_and_baseline(hg_data, baseline_csv = file_path_to_baseline, lWin = 200, lOver = 50, choice_locked = T)
  
  # with behavior #
  hg_behave <- merge.data.frame(hg_clean, behave_data_28, by.x = "trial", by.y = "round", all.x = T, all.y = F)
  # clean any missing RTs #
  hg_behave <- hg_behave %>% filter(!is.na(RT))
  # save it #
  write.csv(hg_behave, clean_name)

}


# delta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_delta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "delta_behave_choice_rscaler_2575_200.csv")
load_IR28_choice_data(file_path_to_power_data, clean_name)
# theta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_theta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "theta_behave_choice_rscaler_2575_200.csv")
load_IR28_choice_data(file_path_to_power_data, clean_name)
# alpha #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_alpha_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "alpha_behave_choice_rscaler_2575_200.csv")
load_IR28_choice_data(file_path_to_power_data, clean_name)
# beta #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_beta_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "beta_behave_choice_rscaler_2575_200.csv")
load_IR28_choice_data(file_path_to_power_data, clean_name)
# gamma #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_gamma_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "gamma_behave_choice_rscaler_2575_200.csv")
load_IR28_choice_data(file_path_to_power_data, clean_name)
# hfa #
file_path_to_power_data <- path(here(), "munge", "savio_cluster", "IR28_hfa_munge_choice_locked_rscaler_2575.csv")
clean_name <- path(here(), "munge", "IR28", "hfa_behave_choice_rscaler_2575_200.csv")
load_IR28_choice_data(file_path_to_power_data, clean_name)

beep(2)
```
