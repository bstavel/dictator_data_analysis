---
title: "Visualize Results - Hilbert - Fall 2020"
author: "Brooke Staveland"
date: "4/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo <- FALSE,  # don't print the code chunk
  warning <- FALSE,  # don't print warnings
  message <- FALSE,  # don't print messages
  fig.width <- 5,  # set default width of figures
  fig.height <- 8,  # set default height of figures
  fig.align <- "center",  # always align figure in center
  fig.pos <- "H",  # always plot figure at the exact location of the code chunk
  cache <- FALSE)  # cache results

## libraries ##
library(tidyverse)
library(ggplot2)
library(magrittr)
library(ggthemr)
library(grid)
library(gtable)
library(gridExtra)
library(wesanderson)
library(ggsci)
library(zoo)
library(kableExtra)
library(lme4)
library(RColorBrewer)
library(doParallel)
library(parallel)
library(foreach)
library(here)
library(fs)
library(ggcorrplot)
library(viridis)
library(lmtest)

## hand written functions ##
source(path(here(), "R", "load_behave_data.R"))
source(path(here(), "R", "prep_behave_data.R"))
source(path(here(), "R", "stretch_start_end.R"))
source(path(here(), "R", "load_high_gamma_data.R"))
source(path(here(), "R", "rolling_window_and_baseline.R"))
source(path(here(), "R", "run_permuted_regressions.R"))
source(path(here(), "R", "compile_results.R"))
source(path(here(), "R", "run_filtered_anova.R"))
source(path(here(), "R", "merge_stepped_anova_results.R"))
# source('~/Projects/nice_r_functions/ggpaired_pretty.R')
source(path(here(), "R", 'mutate_cond.R'))

## plotting helpers ##
ggthemr("solarized")

## parallelization ##
nCores <- 2
registerDoParallel(nCores)

```

# Dictator Game Regression Results

This analysis script visualizes the output of the permuted regressions for all frequencies.


*Links*
[Presentation](#pres)

[Presentation ~ Delta](#p-d)

[Presentation ~ Theta](#p-t)

[Presentation ~ Alpha](#p-a)

[Presentation ~ Beta](#p-b)

[Presentation ~ Gamma](#p-g)

[Presentation ~ HFA](#p-h)


[Choice](#chocie)

[Choice ~ Delta](#c-d)

[Choice ~ Theta](#c-t)

[Choice ~ Alpha](#c-a)

[Choice ~ Beta](#c-b)

[Choice ~ Gamma](#c-g)

[Choice ~ HFA](#c-h)

[Table](#table)

```{r concatenate-results-presentation, echo = F}

### any subject general vars ###
spec_vars <- c("*", "*")
abs_beta_val <- F
regions_to_combine <- c("All")
 
# IR39 has strange behavior # 
# ## IR39 ##
# 
# # combine different csvs #
# presentation_results_39 <- compile_results(regions = regions_to_combine,
#                                            type = "pres-locked",
#                                            sub = "IR39",
#                                            spec_vars = spec_vars,
#                                            path = path(here(), "results", "IR39", "insula"),
#                                            absBeta = F)
# 



## IR35 ##

# combine different csvs #
hfa_presentation_results_35 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR35", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR35", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_35 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR35", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR35", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)


# ## IR19 has weird behavior  ##
# 
# # combine different csvs #
# theta_presentation_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "theta-pres-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all"), 
#                                            absBeta = abs_beta_val)
# 
# hfa_presentation_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "hfa-pres-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all"), 
#                                            absBeta = abs_beta_val)
# 



## IR16 ##

# combine different csvs #
hfa_presentation_results_16 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR16", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR16", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_16 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR16", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR16", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)


## IR26 ##

# combine different csvs #
hfa_presentation_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)




## IR9 ##

# combine different csvs #
hfa_presentation_results_9 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR9", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR9", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_9 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR9", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR9", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)


## IR10 ##

# combine different csvs #
hfa_presentation_results_10 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR10", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR10", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_10 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR10", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR10", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

## IR26 ##

# combine different csvs #
hfa_presentation_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)


## IR28 ##

# combine different csvs #
hfa_presentation_results_28 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-pres-locked-hilbertRS", 
                                           sub = "IR28", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR28", "post_eda"), 
                                           absBeta = abs_beta_val)

delta_presentation_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "delta-pres-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28", "post_eda"),
                                           absBeta = abs_beta_val)

theta_presentation_results_28 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-pres-locked-hilbertRS", 
                                           sub = "IR28", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR28", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_presentation_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-pres-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28", "post_eda"),
                                           absBeta = abs_beta_val)

beta_presentation_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "beta-pres-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_presentation_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-pres-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28", "post_eda"),
                                           absBeta = abs_beta_val)



```

```{r concatenate-results-choice, echo =F}

### any subject general vars ###
spec_vars <- c("*", "*")
abs_beta_val <- F
regions_to_combine <- c("All")
  
# ## IR39 ##
# 
# # combine different csvs #
# choice_results_39_all <- compile_results(regions = regions_to_combine,
#                                            type = "choice-locked",
#                                            sub = "IR39",
#                                            spec_vars = spec_vars,
#                                            path = path(here(), "results", "IR39"),
#                                            absBeta = F)
# 


## IR35 ##

# combine different csvs #
delta_choice_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

theta_choice_results_35 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR35", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR35", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

beta_choice_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_choice_results_35 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR35",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR35", "post_eda"),
                                           absBeta = abs_beta_val)

hfa_choice_results_35 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR35", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR35", "post_eda"), 
                                           absBeta = abs_beta_val)



# ## IR19 ##
# 
# # combine different csvs #
# delta_choice_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "delta-choice-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all", "choice"), 
#                                            absBeta = abs_beta_val)
# 
# theta_choice_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "theta-choice-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all", "choice"), 
#                                            absBeta = abs_beta_val)
# alpha_choice_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "alpha-choice-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all", "choice"), 
#                                            absBeta = abs_beta_val)
# 
# beta_choice_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "beta-choice-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all", "choice"), 
#                                            absBeta = abs_beta_val)
# 
# gamma_choice_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "gamma-choice-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all", "choice"), 
#                                            absBeta = abs_beta_val)
# 
# hfa_choice_results_19 <- compile_results(regions = regions_to_combine, 
#                                            type = "hfa-choice-locked-hilbertRS", 
#                                            sub = "IR19", 
#                                            spec_vars = spec_vars, 
#                                            path = path(here(), "results", "IR19", "all", "choice"), 
#                                            absBeta = abs_beta_val)



## IR26 ##

# combine different csvs #
delta_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

theta_choice_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

beta_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

hfa_choice_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)


## IR28 ##

# # combine different csvs #
delta_choice_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28", "post_eda"), 
                                           absBeta = abs_beta_val)

theta_choice_results_28 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR28", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR28", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28",  "post_eda"), 
                                           absBeta = abs_beta_val)

beta_choice_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28",  "post_eda"), 
                                           absBeta = abs_beta_val)

gamma_choice_results_28 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR28",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR28",  "post_eda"), 
                                           absBeta = abs_beta_val)

hfa_choice_results_28 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR28", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR28", "post_eda"), 
                                           absBeta = abs_beta_val)


## IR9 ##

# combine different csvs #
delta_choice_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

theta_choice_results_9 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR9", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR9", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

beta_choice_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_choice_results_9 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR9",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR9", "post_eda"),
                                           absBeta = abs_beta_val)

hfa_choice_results_9 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR9", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR9", "post_eda"), 
                                           absBeta = abs_beta_val)


## IR10 ##

# combine different csvs #
delta_choice_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

theta_choice_results_10 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR10", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR10", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

beta_choice_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_choice_results_10 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR10",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR10", "post_eda"),
                                           absBeta = abs_beta_val)

hfa_choice_results_10 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR10", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR10", "post_eda"), 
                                           absBeta = abs_beta_val)


## IR26 ##

# combine different csvs #
delta_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

theta_choice_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

beta_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_choice_results_26 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR26",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR26", "post_eda"),
                                           absBeta = abs_beta_val)

hfa_choice_results_26 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR26", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR26", "post_eda"), 
                                           absBeta = abs_beta_val)


## IR16 ##

# combine different csvs #
delta_choice_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "delta-choice-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

theta_choice_results_16 <- compile_results(regions = regions_to_combine, 
                                           type = "theta-choice-locked-hilbertRS", 
                                           sub = "IR16", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR16", "post_eda"), 
                                           absBeta = abs_beta_val)
alpha_choice_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "alpha-choice-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

beta_choice_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "beta-choice-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

gamma_choice_results_16 <- compile_results(regions = regions_to_combine,
                                           type = "gamma-choice-locked-hilbertRS",
                                           sub = "IR16",
                                           spec_vars = spec_vars,
                                           path = path(here(), "results", "IR16", "post_eda"),
                                           absBeta = abs_beta_val)

hfa_choice_results_16 <- compile_results(regions = regions_to_combine, 
                                           type = "hfa-choice-locked-hilbertRS", 
                                           sub = "IR16", 
                                           spec_vars = spec_vars, 
                                           path = path(here(), "results", "IR16", "post_eda"), 
                                           absBeta = abs_beta_val)



```

```{r plotting-functions, echo = F}
ggthemr::ggthemr("pale", layout = "plain")
getPalette = colorRampPalette(brewer.pal(10, "Set1"))

ineq_plots <- function(df, title) {
# plots the bar plots of dif in R2 for inequity  
df %>%
    ungroup() %>%
    mutate(sig = if_else(perm_p < 0.05 & anova_p < 0.01, "Significant", "Insignificant")) %>%
    mutate_cond(sig == "Significant", sig = as.character(region)) %>%
    mutate(sig = relevel(factor(sig), ref = "Insignificant")) %>%
    mutate(bin = as.numeric(gsub("bin_", "", bin))) %>%
    arrange(bin) %>%
    ggplot(., aes( x = bin, y = diff_adj_r2, color = sig, fill = sig)) +
    geom_col(alpha = .5) +
    # geom_vline(aes(xintercept = which(levels(bin) %in% "post_1"))) +
    theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.background = element_rect(fill = "white")) + 
    scale_fill_manual(values = c("grey", getPalette(4))) +
    scale_color_manual(values = c("grey", getPalette(4))) +
    labs(y = "Difference in Adj. R Squared", x = "Bins", fill = "Region", color = "Region") +
    facet_wrap(~electrode) + 
    ggtitle(title)
  
}

ineq_plots_choice <- function(df, title) {
# plots the bar plots of dif in R2 for inequity  
df %>%
    ungroup() %>%
    mutate(sig = if_else(perm_p < 0.05 & anova_p < 0.01, "Significant", "Insignificant")) %>%
    mutate_cond(sig == "Significant", sig = as.character(region)) %>%
    mutate(sig = relevel(factor(sig), ref = "Insignificant")) %>%
    mutate(bin = gsub("pre_", "-", bin)) %>%
    mutate(bin = as.numeric(gsub("post_", "", bin))) %>%
    arrange(bin) %>%
    ggplot(., aes( x = bin, y = diff_adj_r2, color = sig, fill = sig)) +
    geom_col(alpha = .5) +
    # geom_vline(aes(xintercept = which(levels(bin) %in% "post_1"))) +
    theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.background = element_rect(fill = "white")) + 
    scale_fill_manual(values = c("grey", getPalette(4))) +
    scale_color_manual(values = c("grey", getPalette(4))) +
    labs(y = "Difference in Adj. R Squared", x = "Bins", fill = "Region", color = "Region") +
    facet_wrap(~electrode) + 
    ggtitle(title)
  
}

active_elec_plots <- function(df, var, title) {
  df %>%
    filter(predictor == var) %>%
    mutate(sig = if_else(perm_p < 0.0125 & p < 0.05, "Significant", "Insignificant")) %>%
    mutate_cond(sig == "Significant", sig = as.character(region)) %>%
    mutate(sig = relevel(factor(sig), ref = "Insignificant")) %>%
    # mutate(bin = factor(bin, levels = colnames(hg_data)[4:38])) %>%
    ggplot(., aes( x = bin, y = R2, color = sig, fill = sig)) +
    geom_col(alpha = .5) +
    # geom_vline(aes(xintercept = which(levels(bin) %in% "post_1"))) +
    theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.background = element_rect(fill = "white")) + 
    scale_fill_manual(values = c("grey", getPalette(4))) +
    scale_color_manual(values = c("grey", getPalette(4))) +
    labs(y = "Adj. R Squared", x = "Bins", fill = "Region", color = "Region") +
    facet_wrap(~electrode) + 
    ggtitle(title)

}

combined_active_plots <- function(df, subject, num_rows, sig_thresh, vars = c("self_payoff", "self_foregone", "other_payoff", "other_foregone")){
  df  %>%
    filter(predictor %in% vars) %>%
    mutate(bin_sig = if_else((p < .05 & perm_p < sig_thresh), 1, 0)) %>%
    # mutate(Beta = if_else(predictor == "ineq_advent", Beta * -1, Beta)) %>%
    mutate(bin_sig = if_else(Beta < 0 & bin_sig == 1, -1, bin_sig)) %>%
    group_by(bin, electrode) %>%
    mutate(bin_sum = sum(bin_sig)/6) %>%
    ungroup() %>%
    mutate(predictor_sig = if_else(bin_sig == 0, "Insig", as.character(predictor))) %>%
    mutate(predictor_sig = relevel(factor(predictor_sig, levels = c("Insig", vars)), ref = "Insig")) %>%
    mutate(bin = as.numeric(gsub("bin_", "", bin))) %>%
    arrange(bin) %>%
    ggplot(., aes(x= bin, y = bin_sig, fill = predictor_sig, color = predictor_sig)) + 
    geom_col(alpha = .5) + 
    theme(axis.text.x = element_text(angle = 90),
          # axis.ticks.x = element_blank(),
          panel.background = element_rect(fill = "white")) +
      scale_fill_manual(values = c("grey", getPalette(9))) +
      scale_color_manual(values = c("grey", getPalette(9))) +
      labs(y = "number of sig. predictors", x = "Bins", fill = "Region", color = "Region") +
    facet_wrap(~ROI, nrow = num_rows) +
    ggtitle(paste0(subject, " ~ thresh @ ", sig_thresh))
}

combined_active_plots_choice <- function(df, subject, num_rows, sig_thresh){
  df  %>%
    # filter(!predictor %in% c("ineq_advent", "ineq_disadvent")) %>%
    mutate(bin_sig = if_else((p < .05 & perm_p < sig_thresh), 1, 0)) %>%
    mutate(Beta = if_else(predictor == "ineq_advent", Beta * -1, Beta)) %>%
    mutate(bin_sig = if_else(Beta < 0 & bin_sig == 1, -1, bin_sig)) %>%
    group_by(bin, electrode) %>%
    mutate(bin_sum = sum(bin_sig)/6) %>%
    ungroup() %>%
    mutate(predictor = if_else(bin_sig == 0, "Insig", as.character(predictor))) %>%
    mutate(predictor = relevel(factor(predictor), ref = "Insig")) %>%
    mutate(bin = gsub("pre_", "-", bin)) %>%
    mutate(bin = as.numeric(gsub("post_", "", bin))) %>%
    arrange(bin) %>%
    ggplot(., aes(x= bin, y = bin_sig, fill = predictor, color = predictor)) + 
    geom_col(alpha = .5) + 
    geom_vline(xintercept = 0, color = "black") +
    theme(axis.text.x = element_text(angle = 90),
          # axis.ticks.x = element_blank(),
          panel.background = element_rect(fill = "white")) +
      scale_fill_manual(values = c("grey", getPalette(9))) +
      scale_color_manual(values = c("grey", getPalette(9))) +
      labs(y = "number of sig. predictors", x = "Bins", fill = "Region", color = "Region") +
    facet_wrap(~electrode, nrow = num_rows) +
    ggtitle(paste0(subject, " ~ thresh @ ", sig_thresh))
}

combined_active_plots_for_talk <- function(df, subject, num_rows, sig_thresh){
  df  %>%
    filter(!predictor %in% c("ineq_advent", "ineq_disadvent", "self_diff", "other_diff")) %>%
    mutate(bin_sig = if_else((p < .05 & perm_p < sig_thresh), 1, 0)) %>%
    mutate(Beta = if_else(predictor == "ineq_advent", Beta * -1, Beta)) %>%
    mutate(bin_sig = if_else(Beta < 0 & bin_sig == 1, -1, bin_sig)) %>%
    group_by(bin, electrode) %>%
    mutate(bin_sum = sum(bin_sig)/6) %>%
    ungroup() %>%
    mutate(predictor_case = if_else(grepl("other|disadvent", predictor), "ther", "elf")) %>%
    mutate(predictor_case = if_else(bin_sig == 0, "Insig", as.character(predictor_case))) %>%
    mutate(predictor_case = relevel(factor(predictor_case), ref = "Insig")) %>%
    mutate(bin = as.numeric(gsub("bin_", "", bin))) %>%
    arrange(bin) %>%
    ggplot(., aes(x= bin, y = bin_sig, fill = predictor_case, color = predictor_case)) + 
    geom_col(alpha = .5) + 
    theme(axis.text.x = element_text(angle = 90),
          # axis.ticks.x = element_blank(),
          panel.background = element_rect(fill = "white")) +
      scale_fill_manual(values = c("grey", getPalette(9))) +
      scale_color_manual(values = c("grey", getPalette(9))) +
      labs(y = "number of sig. predictors", x = "Bins", fill = "Regressor", color = "Regressor") +
    facet_wrap(~electrode, nrow = num_rows) +
    ggtitle(paste0(subject))
}



combined_active_plots_choice_for_talk <- function(df, subject, num_rows, sig_thresh){
  df  %>%
    # filter(!predictor %in% c("ineq_advent", "ineq_disadvent")) %>%
    mutate(bin_sig = if_else((p < .05 & perm_p < sig_thresh), 1, 0)) %>%
    mutate(bin_sig = if_else(Beta < 0 & bin_sig == 1, -1, bin_sig)) %>%
    group_by(bin, electrode) %>%
    mutate(bin_sum = sum(bin_sig)/6) %>%
    ungroup() %>%
    mutate(predictor_case = if_else(grepl("other|disadvent", predictor), "other", "self")) %>%
    mutate(predictor_case = if_else(bin_sig == 0, "Insig", as.character(predictor_case))) %>%
    mutate(predictor_case = relevel(factor(predictor_case), ref = "Insig")) %>%
    mutate(bin = gsub("pre_", "-", bin)) %>%
    mutate(bin = as.numeric(gsub("post_", "", bin))) %>%
    arrange(bin) %>%
    ggplot(., aes(x= bin, y = bin_sig, fill = predictor_case, color = predictor_case)) + 
    geom_col(alpha = .5) + 
    geom_vline(xintercept = 0, color = "black") +
    theme(axis.text.x = element_text(angle = 90),
          # axis.ticks.x = element_blank(),
          panel.background = element_rect(fill = "white")) +
      scale_fill_manual(values = c("grey", getPalette(8))) +
      scale_color_manual(values = c("grey", getPalette(8))) +
      labs(y = "number of sig. predictors", x = "Bins", fill = "Regressor", color = "Regressor") +
    facet_wrap(~electrode, nrow = num_rows) +
    ggtitle(paste0(subject))
}

beta_plots_all_subjects <- function(df, subject, sig_thresh, nrows, vars = c("self_payoff", "ineq_advent", "other_payoff", "ineq_disadvent")){
   plot_df <- df %>%
    filter(predictor %in% vars) %>%
    mutate(bin_sig = if_else((p < .05 & perm_p < sig_thresh), 1, 0)) %>%
    mutate(predictor_sig = if_else(bin_sig == 0, "Insig", as.character(predictor))) %>%
    mutate(predictor_sig = relevel(factor(predictor_sig, levels = c("Insig", vars)), ref = "Insig")) %>%
    mutate(bin = as.numeric(gsub("bin_", "", bin))) %>%
    arrange(bin)
   
   # create labeler for ROIs
    roi_labels <- paste(plot_df$ROI, "\n elec: ", plot_df$electrode)
    names(roi_labels) <- plot_df$electrode
    
    plot_df %>%
      ggplot(., aes(x = bin, y= Beta)) +
      geom_line(aes(group = predictor), color = "grey", alpha = .3) +
      geom_point(aes(color = predictor_sig), size = 3) + 
      geom_vline(xintercept = 0, color = "black") +
      theme(axis.text.x = element_text(angle = 90),
            # axis.ticks.x = element_blank(),
            panel.background = element_rect(fill = "white")) +
        scale_fill_manual(values = c("grey", getPalette(9)), drop = F) +
        scale_color_manual(values = c("grey", getPalette(9)), drop = F) +
        labs(y = "Beta", x = "Bins",  color = "Regressor") +
      facet_wrap(~electrode, nrow = nrows, labeller = as_labeller(roi_labels)) +
      ggtitle(paste0(subject, " ~ thresh @ ", sig_thresh))
}

beta_plots_all_subjects_choice <- function(df, subject, sig_thresh, nrows, vars = c("self_payoff", "ineq_advent", "other_payoff", "ineq_disadvent"), regions = c("*")){
      
    plot_df <- df %>%
        filter(predictor %in% vars) %>%
        filter(grepl(paste(regions, collapse = "|"), ROI)) %>%
        mutate(bin_sig = if_else((p < .05 & perm_p < sig_thresh), 1, 0)) %>%
        mutate(predictor_sig = if_else(bin_sig == 0, "Insig", as.character(predictor))) %>%
        mutate(predictor_sig = relevel(factor(predictor_sig, levels = c("Insig", vars)), ref = "Insig")) %>%
        mutate(bin = gsub("pre_", "-", bin)) %>%
        mutate(bin = as.numeric(gsub("post_", "", bin))) %>%
        arrange(bin)
    
    # create labeler for ROIs
    roi_labels <- paste(plot_df$ROI, "\n elec: ", plot_df$electrode)
    names(roi_labels) <- plot_df$electrode
      
    plot_df %>%  
        ggplot(., aes(x = bin, y= Beta, color = predictor_sig)) +
        geom_line(aes(group = predictor), color = "grey", alpha = .3) +
        geom_point(aes(color = predictor_sig), size = 3) + 
        geom_vline(xintercept = 0, color = "black") +
        geom_vline(xintercept = 20, color = "black") +
        theme(axis.text.x = element_text(angle = 90),
              # axis.ticks.x = element_blank(),
              panel.background = element_rect(fill = "white")) +
          scale_fill_manual(values = c("grey", getPalette(9)), drop = F) +
          scale_color_manual(values = c("grey", getPalette(9)), drop = F) +
          labs(y = "Beta", x = "Bins",  color = "Regressor") +
        facet_wrap(~electrode, nrow = nrows, labeller = as_labeller(roi_labels)) +
        ggtitle(paste0(subject, " ~ thresh @ ", sig_thresh))
}



```

## Presentation Results {#pres}

```{r presentation-localization, echo = F}


merge_with_elec_info <- function(df, localizations_sub) {
## merge df with elec info, stored in localizations_sub
## creates new var of form ROI1-ROI2  
## also cleans elec names
  
  # clean the names
  df <- df %>%
    mutate(electrode = gsub("POL ", "", electrode)) %>%
    mutate(electrode = gsub(" POL", "", electrode)) %>%
    mutate(electrode = gsub("-Ref", "", electrode)) %>%
    mutate(electrode = gsub("-Ref-", "-", electrode)) 
  
  # separate two electrodes
  df <- df %>%
    mutate(first_elec= gsub("-.*", "", electrode)) %>%
    mutate(second_elec = gsub(".*-", "", electrode))
  # join on first electrode
  df <- left_join(df,
                 localizations_sub,
                 by = c("first_elec" = "Electrode"))
  # rename to `first_region`
  df <- df %>%
    rename(first_region = `Loc Meeting`)
  # join on second electrode and rename
  df <-  left_join(df,
             localizations_sub,
             by = c("second_elec" = "Electrode")) %>%
    rename(second_region = `Loc Meeting`) 
  # paste into useful format
  df <- df %>% mutate(ROI = paste0(first_region, "-", second_region))
  
  return(df)

}


## get region names ##
localizations <- read_csv(path(here(), "munge", "combined_electrode_info_with_bob.csv"))
localizations_28 <- localizations %>% filter(subject == "IR28") %>% select(Electrode, `Loc Meeting`)
localizations_35 <- localizations %>% filter(subject == "IR35") %>% select(Electrode, `Loc Meeting`)
localizations_26 <- localizations %>% filter(subject == "IR26") %>% select(Electrode, `Loc Meeting`)
localizations_9 <- localizations %>% filter(subject == "IR9") %>% select(Electrode, `Loc Meeting`)
localizations_10 <- localizations %>% filter(subject == "IR10") %>% select(Electrode, `Loc Meeting`)
localizations_10 <- localizations_10 %>%
  mutate(Electrode = gsub("POL ", "", Electrode)) %>%
  mutate(Electrode = gsub(" POL", "", Electrode)) %>%
  mutate(Electrode = gsub("-Ref", "", Electrode)) %>%
  mutate(Electrode = gsub("-Ref-", "-", Electrode)) 
localizations_26 <- localizations %>% filter(subject == "IR26") %>% select(Electrode, `Loc Meeting`)
localizations_16 <- localizations %>% filter(subject == "IR16") %>% select(Electrode, `Loc Meeting`)


### clean data ###
# IR9 #
delta_presentation_cleaned_results_9 <- merge_with_elec_info(delta_presentation_results_9,
                                                            localizations_9)
theta_presentation_cleaned_results_9 <- merge_with_elec_info(theta_presentation_results_9,
                                                              localizations_9)
beta_presentation_cleaned_results_9 <- merge_with_elec_info(beta_presentation_results_9,
                                                              localizations_9)
alpha_presentation_cleaned_results_9 <- merge_with_elec_info(alpha_presentation_results_9,
                                                            localizations_9)
gamma_presentation_cleaned_results_9 <- merge_with_elec_info(gamma_presentation_results_9,
                                                            localizations_9)
hfa_presentation_cleaned_results_9 <- merge_with_elec_info(hfa_presentation_results_9,
                                                            localizations_9)

# IR10 #
delta_presentation_cleaned_results_10 <- merge_with_elec_info(delta_presentation_results_10,
                                                            localizations_10)
theta_presentation_cleaned_results_10 <- merge_with_elec_info(theta_presentation_results_10,
                                                              localizations_10)
beta_presentation_cleaned_results_10 <- merge_with_elec_info(beta_presentation_results_10,
                                                              localizations_10)
alpha_presentation_cleaned_results_10 <- merge_with_elec_info(alpha_presentation_results_10,
                                                            localizations_10)
gamma_presentation_cleaned_results_10 <- merge_with_elec_info(gamma_presentation_results_10,
                                                            localizations_10)
hfa_presentation_cleaned_results_10 <- merge_with_elec_info(hfa_presentation_results_10,
                                                            localizations_10)

# IR16 #
delta_presentation_cleaned_results_16 <- merge_with_elec_info(delta_presentation_results_16,
                                                            localizations_16)
theta_presentation_cleaned_results_16 <- merge_with_elec_info(theta_presentation_results_16,
                                                              localizations_16)
beta_presentation_cleaned_results_16 <- merge_with_elec_info(beta_presentation_results_16,
                                                              localizations_16)
alpha_presentation_cleaned_results_16 <- merge_with_elec_info(alpha_presentation_results_16,
                                                            localizations_16)
gamma_presentation_cleaned_results_16 <- merge_with_elec_info(gamma_presentation_results_16,
                                                            localizations_16)
hfa_presentation_cleaned_results_16 <- merge_with_elec_info(hfa_presentation_results_16,
                                                            localizations_16)

# IR26 #
delta_presentation_cleaned_results_26 <- merge_with_elec_info(delta_presentation_results_26,
                                                            localizations_26)
theta_presentation_cleaned_results_26 <- merge_with_elec_info(theta_presentation_results_26,
                                                              localizations_26)
beta_presentation_cleaned_results_26 <- merge_with_elec_info(beta_presentation_results_26,
                                                              localizations_26)
alpha_presentation_cleaned_results_26 <- merge_with_elec_info(alpha_presentation_results_26,
                                                            localizations_26)
gamma_presentation_cleaned_results_26 <- merge_with_elec_info(gamma_presentation_results_26,
                                                            localizations_26)
hfa_presentation_cleaned_results_26 <- merge_with_elec_info(hfa_presentation_results_26,
                                                            localizations_26)

# IR28 #
delta_presentation_cleaned_results_28 <- merge_with_elec_info(delta_presentation_results_28,
                                                            localizations_28)
theta_presentation_cleaned_results_28 <- merge_with_elec_info(theta_presentation_results_28,
                                                              localizations_28)
beta_presentation_cleaned_results_28 <- merge_with_elec_info(beta_presentation_results_28,
                                                              localizations_28)
alpha_presentation_cleaned_results_28 <- merge_with_elec_info(alpha_presentation_results_28,
                                                            localizations_28)
gamma_presentation_cleaned_results_28 <- merge_with_elec_info(gamma_presentation_results_28,
                                                            localizations_28)
hfa_presentation_cleaned_results_28 <- merge_with_elec_info(hfa_presentation_results_28,
                                                            localizations_28)
# IR35 #
delta_presentation_cleaned_results_35 <- merge_with_elec_info(delta_presentation_results_35,
                                                            localizations_35)
theta_presentation_cleaned_results_35 <- merge_with_elec_info(theta_presentation_results_35,
                                                              localizations_35)
beta_presentation_cleaned_results_35 <- merge_with_elec_info(beta_presentation_results_35,
                                                              localizations_35)
alpha_presentation_cleaned_results_35 <- merge_with_elec_info(alpha_presentation_results_35,
                                                            localizations_35)
gamma_presentation_cleaned_results_35 <- merge_with_elec_info(gamma_presentation_results_35,
                                                            localizations_35)
hfa_presentation_cleaned_results_35 <- merge_with_elec_info(hfa_presentation_results_35,
                                                            localizations_35)
# IR26 #
delta_presentation_cleaned_results_26 <- merge_with_elec_info(delta_presentation_results_26,
                                                            localizations_26)
theta_presentation_cleaned_results_26 <- merge_with_elec_info(theta_presentation_results_26,
                                                              localizations_26)
beta_presentation_cleaned_results_26 <- merge_with_elec_info(beta_presentation_results_26,
                                                              localizations_26)
alpha_presentation_cleaned_results_26 <- merge_with_elec_info(alpha_presentation_results_26,
                                                            localizations_26)
gamma_presentation_cleaned_results_26 <- merge_with_elec_info(gamma_presentation_results_26,
                                                            localizations_26)
hfa_presentation_cleaned_results_26 <- merge_with_elec_info(hfa_presentation_results_26,
                                                            localizations_26)
```

```{r separate-data}


## split left and right for plotting ##
# IR9 #
left_delta_presentation_cleaned_results_9 <- delta_presentation_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_9 <- delta_presentation_cleaned_results_9 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_9 <- theta_presentation_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_9 <- theta_presentation_cleaned_results_9 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_9 <- alpha_presentation_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_9 <- alpha_presentation_cleaned_results_9 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_9 <- beta_presentation_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_9 <- beta_presentation_cleaned_results_9 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_9 <- gamma_presentation_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_9 <- gamma_presentation_cleaned_results_9 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_9 <- hfa_presentation_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_9 <- hfa_presentation_cleaned_results_9 %>% filter(grepl("^R", electrode))

# IR10 #
left_delta_presentation_cleaned_results_10 <- delta_presentation_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_10 <- delta_presentation_cleaned_results_10 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_10 <- theta_presentation_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_10 <- theta_presentation_cleaned_results_10 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_10 <- alpha_presentation_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_10 <- alpha_presentation_cleaned_results_10 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_10 <- beta_presentation_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_10 <- beta_presentation_cleaned_results_10 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_10 <- gamma_presentation_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_10 <- gamma_presentation_cleaned_results_10 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_10 <- hfa_presentation_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_10 <- hfa_presentation_cleaned_results_10 %>% filter(grepl("^R", electrode))

# IR16 #
left_delta_presentation_cleaned_results_16 <- delta_presentation_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_16 <- delta_presentation_cleaned_results_16 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_16 <- theta_presentation_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_16 <- theta_presentation_cleaned_results_16 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_16 <- alpha_presentation_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_16 <- alpha_presentation_cleaned_results_16 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_16 <- beta_presentation_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_16 <- beta_presentation_cleaned_results_16 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_16 <- gamma_presentation_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_16 <- gamma_presentation_cleaned_results_16 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_16 <- hfa_presentation_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_16 <- hfa_presentation_cleaned_results_16 %>% filter(grepl("^R", electrode))


# IR26 #
left_delta_presentation_cleaned_results_26 <- delta_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_26 <- delta_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_26 <- theta_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_26 <- theta_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_26 <- alpha_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_26 <- alpha_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_26 <- beta_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_26 <- beta_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_26 <- gamma_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_26 <- gamma_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_26 <- hfa_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_26 <- hfa_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))


# IR28 #
left_delta_presentation_cleaned_results_28 <- delta_presentation_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_28 <- delta_presentation_cleaned_results_28 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_28 <- theta_presentation_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_28 <- theta_presentation_cleaned_results_28 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_28 <- alpha_presentation_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_28 <- alpha_presentation_cleaned_results_28 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_28 <- beta_presentation_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_28 <- beta_presentation_cleaned_results_28 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_28 <- gamma_presentation_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_28 <- gamma_presentation_cleaned_results_28 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_28 <- hfa_presentation_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_28 <- hfa_presentation_cleaned_results_28 %>% filter(grepl("^R", electrode))


# IR35 #
left_delta_presentation_cleaned_results_35 <- delta_presentation_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_35 <- delta_presentation_cleaned_results_35 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_35 <- theta_presentation_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_35 <- theta_presentation_cleaned_results_35 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_35 <- alpha_presentation_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_35 <- alpha_presentation_cleaned_results_35 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_35 <- beta_presentation_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_35 <- beta_presentation_cleaned_results_35 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_35 <- gamma_presentation_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_35 <- gamma_presentation_cleaned_results_35 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_35 <- hfa_presentation_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_35 <- hfa_presentation_cleaned_results_35 %>% filter(grepl("^R", electrode))


# IR26 #
left_delta_presentation_cleaned_results_26 <- delta_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_delta_presentation_cleaned_results_26 <- delta_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_theta_presentation_cleaned_results_26 <- theta_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_theta_presentation_cleaned_results_26 <- theta_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_alpha_presentation_cleaned_results_26 <- alpha_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_alpha_presentation_cleaned_results_26 <- alpha_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_beta_presentation_cleaned_results_26 <- beta_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_beta_presentation_cleaned_results_26 <- beta_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_gamma_presentation_cleaned_results_26 <- gamma_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_gamma_presentation_cleaned_results_26 <- gamma_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))

left_hfa_presentation_cleaned_results_26 <- hfa_presentation_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_hfa_presentation_cleaned_results_26 <- hfa_presentation_cleaned_results_26 %>% filter(grepl("^R", electrode))


```

### Pres ~ Delta {#p-d}

```{r delta-pres_viz, echo = F, fig.width= 18, fig.height= 22}

## delta ##
beta_plots_all_subjects(left_delta_presentation_cleaned_results_26, "IR26 ~ Left ~ delta ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_26, "IR26 ~ Right ~ delta ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_delta_presentation_cleaned_results_35, "IR35 ~ Left ~ delta ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_35, "IR35 ~ Right ~ delta ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_delta_presentation_cleaned_results_28, "IR28 ~ Left ~ delta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_28, "IR28 ~ Right ~ delta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_delta_presentation_cleaned_results_9, "IR9 ~ Left ~ delta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_9, "IR9 ~ Right ~ delta ~ Pres", 9, sig_thresh = 0.01)

beta_plots_all_subjects(left_delta_presentation_cleaned_results_10, "IR10 ~ Left ~ delta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_10, "IR10 ~ Right ~ delta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_delta_presentation_cleaned_results_26, "IR26 ~ Left ~ delta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_26, "IR26 ~ Right ~ delta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_delta_presentation_cleaned_results_16, "IR16 ~ Left ~ delta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_delta_presentation_cleaned_results_16, "IR16 ~ Right ~ delta ~ Pres", 8, sig_thresh = 0.01)

```

### Pres ~ Theta {#p-t}

```{r theta-pres_viz, echo = F, fig.width= 18, fig.height= 22}

## Theta ##
beta_plots_all_subjects(left_theta_presentation_cleaned_results_26, "IR26 ~ Left ~ Theta ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_26, "IR26 ~ Right ~ Theta ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_theta_presentation_cleaned_results_35, "IR35 ~ Left ~ Theta ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_35, "IR35 ~ Right ~ Theta ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_theta_presentation_cleaned_results_28, "IR28 ~ Left ~ Theta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_28, "IR28 ~ Right ~ Theta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_theta_presentation_cleaned_results_9, "IR9 ~ Left ~ Theta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_9, "IR9 ~ Right ~ Theta ~ Pres", 9, sig_thresh = 0.01)

beta_plots_all_subjects(left_theta_presentation_cleaned_results_10, "IR10 ~ Left ~ Theta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_10, "IR10 ~ Right ~ Theta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_theta_presentation_cleaned_results_26, "IR26 ~ Left ~ Theta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_26, "IR26 ~ Right ~ Theta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_theta_presentation_cleaned_results_16, "IR16 ~ Left ~ Theta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_theta_presentation_cleaned_results_16, "IR16 ~ Right ~ Theta ~ Pres", 8, sig_thresh = 0.01)

```

### Pres ~ Alpha {#p-a}

```{r alpha-pres_viz, echo = F, fig.width= 18, fig.height= 22}

## alpha ##
beta_plots_all_subjects(left_alpha_presentation_cleaned_results_26, "IR26 ~ Left ~ alpha ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_26, "IR26 ~ Right ~ alpha ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_alpha_presentation_cleaned_results_35, "IR35 ~ Left ~ alpha ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_35, "IR35 ~ Right ~ alpha ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_alpha_presentation_cleaned_results_28, "IR28 ~ Left ~ alpha ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_28, "IR28 ~ Right ~ alpha ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_alpha_presentation_cleaned_results_9, "IR9 ~ Left ~ alpha ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_9, "IR9 ~ Right ~ alpha ~ Pres", 9, sig_thresh = 0.01)

beta_plots_all_subjects(left_alpha_presentation_cleaned_results_10, "IR10 ~ Left ~ alpha ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_10, "IR10 ~ Right ~ alpha ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_alpha_presentation_cleaned_results_26, "IR26 ~ Left ~ alpha ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_26, "IR26 ~ Right ~ alpha ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_alpha_presentation_cleaned_results_16, "IR16 ~ Left ~ alpha ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_alpha_presentation_cleaned_results_16, "IR16 ~ Right ~ alpha ~ Pres", 8, sig_thresh = 0.01)

```

### Pres ~ Beta {#p-b}

```{r beta-pres_viz, echo = F, fig.width= 18, fig.height= 22}

## beta ##
beta_plots_all_subjects(left_beta_presentation_cleaned_results_26, "IR26 ~ Left ~ beta ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_26, "IR26 ~ Right ~ beta ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_beta_presentation_cleaned_results_35, "IR35 ~ Left ~ beta ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_35, "IR35 ~ Right ~ beta ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_beta_presentation_cleaned_results_28, "IR28 ~ Left ~ beta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_28, "IR28 ~ Right ~ beta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_beta_presentation_cleaned_results_9, "IR9 ~ Left ~ beta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_9, "IR9 ~ Right ~ beta ~ Pres", 9, sig_thresh = 0.01)

beta_plots_all_subjects(left_beta_presentation_cleaned_results_10, "IR10 ~ Left ~ beta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_10, "IR10 ~ Right ~ beta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_beta_presentation_cleaned_results_26, "IR26 ~ Left ~ beta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_26, "IR26 ~ Right ~ beta ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_beta_presentation_cleaned_results_16, "IR16 ~ Left ~ beta ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_beta_presentation_cleaned_results_16, "IR16 ~ Right ~ beta ~ Pres", 8, sig_thresh = 0.01)

```

### Pres ~ Gamma {#p-g}

```{r gamma-pres_viz, echo = F, fig.width= 18, fig.height= 22}

## gamma ##
beta_plots_all_subjects(left_gamma_presentation_cleaned_results_26, "IR26 ~ Left ~ gamma ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_26, "IR26 ~ Right ~ gamma ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_gamma_presentation_cleaned_results_35, "IR35 ~ Left ~ gamma ~ Pres", 10, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_35, "IR35 ~ Right ~ gamma ~ Pres", 10, sig_thresh = 0.01)

beta_plots_all_subjects(left_gamma_presentation_cleaned_results_28, "IR28 ~ Left ~ gamma ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_28, "IR28 ~ Right ~ gamma ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_gamma_presentation_cleaned_results_9, "IR9 ~ Left ~ gamma ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_9, "IR9 ~ Right ~ gamma ~ Pres", 9, sig_thresh = 0.01)

beta_plots_all_subjects(left_gamma_presentation_cleaned_results_10, "IR10 ~ Left ~ gamma ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_10, "IR10 ~ Right ~ gamma ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_gamma_presentation_cleaned_results_26, "IR26 ~ Left ~ gamma ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_26, "IR26 ~ Right ~ gamma ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_gamma_presentation_cleaned_results_16, "IR16 ~ Left ~ gamma ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_gamma_presentation_cleaned_results_16, "IR16 ~ Right ~ gamma ~ Pres", 8, sig_thresh = 0.01)

```

### Pres ~ HFA {#p-h}

```{r hfa-pres_viz, echo = F, fig.width= 18, fig.height= 22}

## HFA ##
beta_plots_all_subjects(left_hfa_presentation_cleaned_results_26, "IR26 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_26, "IR26 ~ Right ~ HFA ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_hfa_presentation_cleaned_results_35, "IR35 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_35, "IR35 ~ Right ~ HFA ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_hfa_presentation_cleaned_results_28, "IR28 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_28, "IR28 ~ Right ~ HFA ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_hfa_presentation_cleaned_results_9, "IR9 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_9, "IR9 ~ Right ~ HFA ~ Pres", 9, sig_thresh = 0.01)

beta_plots_all_subjects(left_hfa_presentation_cleaned_results_10, "IR10 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_10, "IR10 ~ Right ~ HFA ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_hfa_presentation_cleaned_results_26, "IR26 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_26, "IR26 ~ Right ~ HFA ~ Pres", 8, sig_thresh = 0.01)

beta_plots_all_subjects(left_hfa_presentation_cleaned_results_16, "IR16 ~ Left ~ HFA ~ Pres", 8, sig_thresh = 0.01)
beta_plots_all_subjects(right_hfa_presentation_cleaned_results_16, "IR16 ~ Right ~ HFA ~ Pres", 8, sig_thresh = 0.01)

```


# Choice Results {#choice}


```{r choice-localization, echo = F}

# IR35 #
delta_choice_cleaned_results_35 <- merge_with_elec_info(delta_choice_results_35, localizations_35)
theta_choice_cleaned_results_35 <- merge_with_elec_info(theta_choice_results_35, localizations_35)
alpha_choice_cleaned_results_35 <- merge_with_elec_info(alpha_choice_results_35, localizations_35)
beta_choice_cleaned_results_35 <- merge_with_elec_info(beta_choice_results_35, localizations_35)
gamma_choice_cleaned_results_35 <- merge_with_elec_info(gamma_choice_results_35, localizations_35)
hfa_choice_cleaned_results_35 <- merge_with_elec_info(hfa_choice_results_35, localizations_35)
# IR26#
delta_choice_cleaned_results_26 <- merge_with_elec_info(delta_choice_results_26, localizations_26)
theta_choice_cleaned_results_26 <- merge_with_elec_info(theta_choice_results_26, localizations_26)
alpha_choice_cleaned_results_26 <- merge_with_elec_info(alpha_choice_results_26, localizations_26)
beta_choice_cleaned_results_26 <- merge_with_elec_info(beta_choice_results_26, localizations_26)
gamma_choice_cleaned_results_26 <- merge_with_elec_info(gamma_choice_results_26, localizations_26)
hfa_choice_cleaned_results_26 <- merge_with_elec_info(hfa_choice_results_26, localizations_26)
# IR28 #
delta_choice_cleaned_results_28 <- merge_with_elec_info(delta_choice_results_28, localizations_28)
theta_choice_cleaned_results_28 <- merge_with_elec_info(theta_choice_results_28, localizations_28)
alpha_choice_cleaned_results_28 <- merge_with_elec_info(alpha_choice_results_28, localizations_28)
beta_choice_cleaned_results_28 <- merge_with_elec_info(beta_choice_results_28, localizations_28)
gamma_choice_cleaned_results_28 <- merge_with_elec_info(gamma_choice_results_28, localizations_28)
hfa_choice_cleaned_results_28 <- merge_with_elec_info(hfa_choice_results_28, localizations_28)
# IR9 #
delta_choice_cleaned_results_9 <- merge_with_elec_info(delta_choice_results_9, localizations_9)
theta_choice_cleaned_results_9 <- merge_with_elec_info(theta_choice_results_9, localizations_9)
alpha_choice_cleaned_results_9 <- merge_with_elec_info(alpha_choice_results_9, localizations_9)
beta_choice_cleaned_results_9 <- merge_with_elec_info(beta_choice_results_9, localizations_9)
gamma_choice_cleaned_results_9 <- merge_with_elec_info(gamma_choice_results_9, localizations_9)
hfa_choice_cleaned_results_9 <- merge_with_elec_info(hfa_choice_results_9, localizations_9)
# IR10 #
delta_choice_cleaned_results_10 <- merge_with_elec_info(delta_choice_results_10, localizations_10)
theta_choice_cleaned_results_10 <- merge_with_elec_info(theta_choice_results_10, localizations_10)
alpha_choice_cleaned_results_10 <- merge_with_elec_info(alpha_choice_results_10, localizations_10)
beta_choice_cleaned_results_10 <- merge_with_elec_info(beta_choice_results_10, localizations_10)
gamma_choice_cleaned_results_10 <- merge_with_elec_info(gamma_choice_results_10, localizations_10)
hfa_choice_cleaned_results_10 <- merge_with_elec_info(hfa_choice_results_10, localizations_10)
# # IR26 #
delta_choice_cleaned_results_26 <- merge_with_elec_info(delta_choice_results_26, localizations_26)
theta_choice_cleaned_results_26 <- merge_with_elec_info(theta_choice_results_26, localizations_26)
alpha_choice_cleaned_results_26 <- merge_with_elec_info(alpha_choice_results_26, localizations_26)
beta_choice_cleaned_results_26 <- merge_with_elec_info(beta_choice_results_26, localizations_26)
gamma_choice_cleaned_results_26 <- merge_with_elec_info(gamma_choice_results_26, localizations_26)
hfa_choice_cleaned_results_26 <- merge_with_elec_info(hfa_choice_results_26, localizations_26)
# IR16 #
delta_choice_cleaned_results_16 <- merge_with_elec_info(delta_choice_results_16, localizations_16)
theta_choice_cleaned_results_16 <- merge_with_elec_info(theta_choice_results_16, localizations_16)
alpha_choice_cleaned_results_16 <- merge_with_elec_info(alpha_choice_results_16, localizations_16)
beta_choice_cleaned_results_16 <- merge_with_elec_info(beta_choice_results_16, localizations_16)
gamma_choice_cleaned_results_16 <- merge_with_elec_info(gamma_choice_results_16, localizations_16)
hfa_choice_cleaned_results_16 <- merge_with_elec_info(hfa_choice_results_16, localizations_16)

```

```{r choice-split-data}

# delta #
left_delta_choice_cleaned_results_35 <- delta_choice_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_35 <- delta_choice_cleaned_results_35 %>% filter(grepl("^R", electrode))
left_delta_choice_cleaned_results_26 <- delta_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_26 <- delta_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_delta_choice_cleaned_results_28 <- delta_choice_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_28 <- delta_choice_cleaned_results_28 %>% filter(grepl("^R", electrode))
left_delta_choice_cleaned_results_9 <- delta_choice_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_9 <- delta_choice_cleaned_results_9 %>% filter(grepl("^R", electrode))
left_delta_choice_cleaned_results_10 <- delta_choice_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_10 <- delta_choice_cleaned_results_10 %>% filter(grepl("^R", electrode))
left_delta_choice_cleaned_results_26 <- delta_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_26 <- delta_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_delta_choice_cleaned_results_16 <- delta_choice_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_delta_choice_cleaned_results_16 <- delta_choice_cleaned_results_16 %>% filter(grepl("^R", electrode))


# theta #
left_theta_choice_cleaned_results_35 <- theta_choice_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_35 <- theta_choice_cleaned_results_35 %>% filter(grepl("^R", electrode))
left_theta_choice_cleaned_results_26 <- theta_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_26 <- theta_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_theta_choice_cleaned_results_28 <- theta_choice_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_28 <- theta_choice_cleaned_results_28 %>% filter(grepl("^R", electrode))
left_theta_choice_cleaned_results_9 <- theta_choice_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_9 <- theta_choice_cleaned_results_9 %>% filter(grepl("^R", electrode))
left_theta_choice_cleaned_results_10 <- theta_choice_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_10 <- theta_choice_cleaned_results_10 %>% filter(grepl("^R", electrode))
left_theta_choice_cleaned_results_26 <- theta_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_26 <- theta_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_theta_choice_cleaned_results_16 <- theta_choice_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_theta_choice_cleaned_results_16 <- theta_choice_cleaned_results_16 %>% filter(grepl("^R", electrode))

# alpha #
left_alpha_choice_cleaned_results_35 <- alpha_choice_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_35 <- alpha_choice_cleaned_results_35 %>% filter(grepl("^R", electrode))
left_alpha_choice_cleaned_results_26 <- alpha_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_26 <- alpha_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_alpha_choice_cleaned_results_28 <- alpha_choice_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_28 <- alpha_choice_cleaned_results_28 %>% filter(grepl("^R", electrode))
left_alpha_choice_cleaned_results_9 <- alpha_choice_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_9 <- alpha_choice_cleaned_results_9 %>% filter(grepl("^R", electrode))
left_alpha_choice_cleaned_results_10 <- alpha_choice_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_10 <- alpha_choice_cleaned_results_10 %>% filter(grepl("^R", electrode))
left_alpha_choice_cleaned_results_26 <- alpha_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_26 <- alpha_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_alpha_choice_cleaned_results_16 <- alpha_choice_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_alpha_choice_cleaned_results_16 <- alpha_choice_cleaned_results_16 %>% filter(grepl("^R", electrode))

# beta #
left_beta_choice_cleaned_results_35 <- beta_choice_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_35 <- beta_choice_cleaned_results_35 %>% filter(grepl("^R", electrode))
left_beta_choice_cleaned_results_26 <- beta_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_26 <- beta_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_beta_choice_cleaned_results_28 <- beta_choice_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_28 <- beta_choice_cleaned_results_28 %>% filter(grepl("^R", electrode))
left_beta_choice_cleaned_results_9 <- beta_choice_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_9 <- beta_choice_cleaned_results_9 %>% filter(grepl("^R", electrode))
left_beta_choice_cleaned_results_10 <- beta_choice_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_10 <- beta_choice_cleaned_results_10 %>% filter(grepl("^R", electrode))
left_beta_choice_cleaned_results_26 <- beta_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_26 <- beta_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_beta_choice_cleaned_results_16 <- beta_choice_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_beta_choice_cleaned_results_16 <- beta_choice_cleaned_results_16 %>% filter(grepl("^R", electrode))

# gamma #
left_gamma_choice_cleaned_results_35 <- gamma_choice_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_35 <- gamma_choice_cleaned_results_35 %>% filter(grepl("^R", electrode))
left_gamma_choice_cleaned_results_26 <- gamma_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_26 <- gamma_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_gamma_choice_cleaned_results_28 <- gamma_choice_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_28 <- gamma_choice_cleaned_results_28 %>% filter(grepl("^R", electrode))
left_gamma_choice_cleaned_results_9 <- gamma_choice_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_9 <- gamma_choice_cleaned_results_9 %>% filter(grepl("^R", electrode))
left_gamma_choice_cleaned_results_10 <- gamma_choice_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_10 <- gamma_choice_cleaned_results_10 %>% filter(grepl("^R", electrode))
left_gamma_choice_cleaned_results_26 <- gamma_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_26 <- gamma_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_gamma_choice_cleaned_results_16 <- gamma_choice_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_gamma_choice_cleaned_results_16 <- gamma_choice_cleaned_results_16 %>% filter(grepl("^R", electrode))


# hfa #
left_hfa_choice_cleaned_results_35 <- hfa_choice_cleaned_results_35 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_35 <- hfa_choice_cleaned_results_35 %>% filter(grepl("^R", electrode))
left_hfa_choice_cleaned_results_26 <- hfa_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_26 <- hfa_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_hfa_choice_cleaned_results_28 <- hfa_choice_cleaned_results_28 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_28 <- hfa_choice_cleaned_results_28 %>% filter(grepl("^R", electrode))
left_hfa_choice_cleaned_results_9 <- hfa_choice_cleaned_results_9 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_9 <- hfa_choice_cleaned_results_9 %>% filter(grepl("^R", electrode))
left_hfa_choice_cleaned_results_10 <- hfa_choice_cleaned_results_10 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_10 <- hfa_choice_cleaned_results_10 %>% filter(grepl("^R", electrode))
left_hfa_choice_cleaned_results_26 <- hfa_choice_cleaned_results_26 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_26 <- hfa_choice_cleaned_results_26 %>% filter(grepl("^R", electrode))
left_hfa_choice_cleaned_results_16 <- hfa_choice_cleaned_results_16 %>% filter(grepl("^L", electrode))
right_hfa_choice_cleaned_results_16 <- hfa_choice_cleaned_results_16 %>% filter(grepl("^R", electrode))



```

### Choice ~ Delta {#c-d}

```{r delta-choice-viz, echo = F, fig.width= 18, fig.height= 22}

## theta ##

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_35, "IR35 ~ Left ~ delta ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_35, "IR35 ~ Right ~ delta ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_26, "IR26 ~ Left ~ delta ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_26, "IR26 ~ Right ~ delta ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_28, "IR28 ~ Left ~ delta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_28, "IR28 ~ Right ~ delta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_9, "IR9 ~ Left ~ delta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_9, "IR9 ~ Right ~ delta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_10, "IR10 ~ Left ~ delta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_10, "IR10 ~ Right ~ delta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_26, "IR26 ~ Left ~ delta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_26, "IR26 ~ Right ~ delta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_delta_choice_cleaned_results_16, "IR16 ~ Left ~ delta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_delta_choice_cleaned_results_16, "IR16 ~ Right ~ delta ~ Choice", 8, sig_thresh = 0.01)

```

### Choice ~ Theta {#c-t}

```{r theta-choice-viz, echo = F, fig.width= 18, fig.height= 22}

## theta ##

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_35, "IR35 ~ Left ~ Theta ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_35, "IR35 ~ Right ~ Theta ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_26, "IR26 ~ Left ~ Theta ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_26, "IR26 ~ Right ~ Theta ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_28, "IR28 ~ Left ~ Theta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_28, "IR28 ~ Right ~ Theta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_9, "IR9 ~ Left ~ Theta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_9, "IR9 ~ Right ~ Theta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_10, "IR10 ~ Left ~ Theta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_10, "IR10 ~ Right ~ Theta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_26, "IR26 ~ Left ~ Theta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_26, "IR26 ~ Right ~ Theta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_theta_choice_cleaned_results_16, "IR16 ~ Left ~ Theta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_theta_choice_cleaned_results_16, "IR16 ~ Right ~ Theta ~ Choice", 8, sig_thresh = 0.01)

```

### Choice ~ Alpha {#c-a}

```{r alpha-choice-viz, echo = F, fig.width= 18, fig.height= 22}

## alpha ##

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_35, "IR35 ~ Left ~ alpha ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_35, "IR35 ~ Right ~ alpha ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_26, "IR26 ~ Left ~ alpha ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_26, "IR26 ~ Right ~ alpha ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_28, "IR28 ~ Left ~ alpha ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_28, "IR28 ~ Right ~ alpha ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_9, "IR9 ~ Left ~ alpha ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_9, "IR9 ~ Right ~ alpha ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_10, "IR10 ~ Left ~ alpha ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_10, "IR10 ~ Right ~ alpha ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_26, "IR26 ~ Left ~ alpha ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_26, "IR26 ~ Right ~ alpha ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_alpha_choice_cleaned_results_16, "IR16 ~ Left ~ alpha ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_alpha_choice_cleaned_results_16, "IR16 ~ Right ~ alpha ~ Choice", 8, sig_thresh = 0.01)

```

### Choice ~ Beta {#c-b}

```{r beta-choice-viz, echo = F, fig.width= 18, fig.height= 22}

## beta ##

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_35, "IR35 ~ Left ~ beta ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_35, "IR35 ~ Right ~ beta ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_26, "IR26 ~ Left ~ beta ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_26, "IR26 ~ Right ~ beta ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_28, "IR28 ~ Left ~ beta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_28, "IR28 ~ Right ~ beta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_9, "IR9 ~ Left ~ beta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_9, "IR9 ~ Right ~ beta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_10, "IR10 ~ Left ~ beta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_10, "IR10 ~ Right ~ beta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_26, "IR26 ~ Left ~ beta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_26, "IR26 ~ Right ~ beta ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_beta_choice_cleaned_results_16, "IR16 ~ Left ~ beta ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_beta_choice_cleaned_results_16, "IR16 ~ Right ~ beta ~ Choice", 8, sig_thresh = 0.01)

```

### Choice ~ Gamma {#c-g}

```{r gamma-choice-viz, echo = F, fig.width= 18, fig.height= 22}

## gamma ##

beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_35, "IR35 ~ Left ~ gamma ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_35, "IR35 ~ Right ~ gamma ~ Choice", 10, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_26, "IR26 ~ Left ~ gamma ~ Choice", 10, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_26, "IR26 ~ Right ~ gamma ~ Choice", 10, sig_thresh = 0.01)

# beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_28, "IR28 ~ Left ~ gamma ~ Choice", 8, sig_thresh = 0.01)
# beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_28, "IR28 ~ Right ~ gamma ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_9, "IR9 ~ Left ~ gamma ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_9, "IR9 ~ Right ~ gamma ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_10, "IR10 ~ Left ~ gamma ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_10, "IR10 ~ Right ~ gamma ~ Choice", 8, sig_thresh = 0.01)

# beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_26, "IR26 ~ Left ~ gamma ~ Choice", 8, sig_thresh = 0.01)
# beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_26, "IR26 ~ Right ~ gamma ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_gamma_choice_cleaned_results_16, "IR16 ~ Left ~ gamma ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_gamma_choice_cleaned_results_16, "IR16 ~ Right ~ gamma ~ Choice", 8, sig_thresh = 0.01)

```

### Choice ~ HFA {#c-h}

```{r hf-choice-viz, echo = F, fig.width= 18, fig.height= 22}

## HFA ##

beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_35, "IR35 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_35, "IR35 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_26, "IR26 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_26, "IR26 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

# beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_28, "IR28 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
# beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_28, "IR28 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_9, "IR9 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_9, "IR9 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_10, "IR10 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_10, "IR10 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

# beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_26, "IR26 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
# beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_26, "IR26 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

beta_plots_all_subjects_choice(left_hfa_choice_cleaned_results_16, "IR16 ~ Left ~ hfa ~ Choice", 8, sig_thresh = 0.01)
beta_plots_all_subjects_choice(right_hfa_choice_cleaned_results_16, "IR16 ~ Right ~ hfa ~ Choice", 8, sig_thresh = 0.01)

```

## Summary Table {#table}

```{r table, echo = F}

all_choice_results <- rbind(delta_choice_cleaned_results_35 %>% mutate(freq = "delta")   %>% mutate(sub = "IR35"),
                     theta_choice_cleaned_results_35 %>% mutate(freq = "theta") %>% mutate(sub = "IR35"),
                     alpha_choice_cleaned_results_35 %>% mutate(freq = "alpha") %>% mutate(sub = "IR35"),
                     beta_choice_cleaned_results_35 %>% mutate(freq = "beta") %>% mutate(sub = "IR35"),
                     gamma_choice_cleaned_results_35 %>% mutate(freq = "gamma") %>% mutate(sub = "IR35"),
                     hfa_choice_cleaned_results_35 %>% mutate(freq = "hfa") %>% mutate(sub = "IR35"),
                     delta_choice_cleaned_results_26 %>% mutate(freq = "delta") %>% mutate(sub = "IR26"),
                     theta_choice_cleaned_results_26 %>% mutate(freq = "theta") %>% mutate(sub = "IR26"),
                     alpha_choice_cleaned_results_26 %>% mutate(freq = "alpha") %>% mutate(sub = "IR26"),
                     beta_choice_cleaned_results_26 %>% mutate(freq = "beta") %>% mutate(sub = "IR26"),
                     gamma_choice_cleaned_results_26 %>% mutate(freq = "gamma") %>% mutate(sub = "IR26"),
                     hfa_choice_cleaned_results_26 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR26"),
                     delta_choice_cleaned_results_28 %>% mutate(freq = "delta")   %>% mutate(sub = "IR28"),
                     theta_choice_cleaned_results_28 %>% mutate(freq = "theta") %>% mutate(sub = "IR28"),
                     alpha_choice_cleaned_results_28 %>% mutate(freq = "alpha") %>% mutate(sub = "IR28"),
                     beta_choice_cleaned_results_28 %>% mutate(freq = "beta") %>% mutate(sub = "IR28"),
                     gamma_choice_cleaned_results_28 %>% mutate(freq = "gamma") %>% mutate(sub = "IR28"),
                     hfa_choice_cleaned_results_28 %>% mutate(freq = "hfa") %>% mutate(sub = "IR28"),
                     delta_choice_cleaned_results_26 %>% mutate(freq = "delta") %>% mutate(sub = "IR26"),
                     theta_choice_cleaned_results_26 %>% mutate(freq = "theta") %>% mutate(sub = "IR26"),
                     alpha_choice_cleaned_results_26 %>% mutate(freq = "alpha") %>% mutate(sub = "IR26"),
                     beta_choice_cleaned_results_26 %>% mutate(freq = "beta") %>% mutate(sub = "IR26"),
                     gamma_choice_cleaned_results_26 %>% mutate(freq = "gamma") %>% mutate(sub = "IR26"),
                     hfa_choice_cleaned_results_26 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR26"),
                     delta_choice_cleaned_results_16 %>% mutate(freq = "delta") %>% mutate(sub = "IR16"),
                     theta_choice_cleaned_results_16 %>% mutate(freq = "theta") %>% mutate(sub = "IR16"),
                     alpha_choice_cleaned_results_16 %>% mutate(freq = "alpha") %>% mutate(sub = "IR16"),
                     beta_choice_cleaned_results_16 %>% mutate(freq = "beta") %>% mutate(sub = "IR16"),
                     gamma_choice_cleaned_results_16 %>% mutate(freq = "gamma") %>% mutate(sub = "IR16"),
                     hfa_choice_cleaned_results_16 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR16"),
                     delta_choice_cleaned_results_10 %>% mutate(freq = "delta")  %>% mutate(sub = "IR10"),
                     theta_choice_cleaned_results_10 %>% mutate(freq = "theta")  %>% mutate(sub = "IR10"),
                     alpha_choice_cleaned_results_10 %>% mutate(freq = "alpha")  %>% mutate(sub = "IR10"),
                     beta_choice_cleaned_results_10 %>% mutate(freq = "beta")  %>% mutate(sub = "IR10"),
                     gamma_choice_cleaned_results_10 %>% mutate(freq = "gamma")  %>% mutate(sub = "IR10"),
                     hfa_choice_cleaned_results_10 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR10"),
                     delta_choice_cleaned_results_9 %>% mutate(freq = "delta")  %>% mutate(sub = "IR9"),
                     theta_choice_cleaned_results_9 %>% mutate(freq = "theta")  %>% mutate(sub = "IR9"),
                     alpha_choice_cleaned_results_9 %>% mutate(freq = "alpha")  %>% mutate(sub = "IR9"),
                     beta_choice_cleaned_results_9 %>% mutate(freq = "beta")  %>% mutate(sub = "IR9"),
                     gamma_choice_cleaned_results_9 %>% mutate(freq = "gamma")  %>% mutate(sub = "IR9"),
                     hfa_choice_cleaned_results_9 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR9"))


all_presentation_results <- rbind(delta_presentation_cleaned_results_35 %>% mutate(freq = "delta") %>% mutate(sub = "IR35"),
                     theta_presentation_cleaned_results_35 %>% mutate(freq = "theta")  %>% mutate(sub = "IR35"),
                     alpha_presentation_cleaned_results_35 %>% mutate(freq = "alpha")  %>% mutate(sub = "IR35"),
                     beta_presentation_cleaned_results_35 %>% mutate(freq = "beta") %>% mutate(sub = "IR35"),
                     gamma_presentation_cleaned_results_35 %>% mutate(freq = "gamma") %>% mutate(sub = "IR35"),
                     hfa_presentation_cleaned_results_35 %>% mutate(freq = "hfa") %>% mutate(sub = "IR35"),
                     delta_presentation_cleaned_results_26 %>% mutate(freq = "delta") %>% mutate(sub = "IR26"),
                     theta_presentation_cleaned_results_26 %>% mutate(freq = "theta") %>% mutate(sub = "IR26"),
                     alpha_presentation_cleaned_results_26 %>% mutate(freq = "alpha") %>% mutate(sub = "IR26"),
                     beta_presentation_cleaned_results_26 %>% mutate(freq = "beta") %>% mutate(sub = "IR26"),
                     gamma_presentation_cleaned_results_26 %>% mutate(freq = "gamma") %>% mutate(sub = "IR26"),
                     hfa_presentation_cleaned_results_26 %>% mutate(freq = "hfa") %>% mutate(sub = "IR26"),
                     delta_presentation_cleaned_results_28 %>% mutate(freq = "delta") %>% mutate(sub = "IR28"),
                     theta_presentation_cleaned_results_28 %>% mutate(freq = "theta")  %>% mutate(sub = "IR28"),
                     alpha_presentation_cleaned_results_28 %>% mutate(freq = "alpha")  %>% mutate(sub = "IR28"),
                     beta_presentation_cleaned_results_28 %>% mutate(freq = "beta") %>% mutate(sub = "IR28"),
                     gamma_presentation_cleaned_results_28 %>% mutate(freq = "gamma") %>% mutate(sub = "IR28"),
                     hfa_presentation_cleaned_results_28 %>% mutate(freq = "hfa") %>% mutate(sub = "IR28"),
                     delta_presentation_cleaned_results_26 %>% mutate(freq = "delta") %>% mutate(sub = "IR26"),
                     theta_presentation_cleaned_results_26 %>% mutate(freq = "theta") %>% mutate(sub = "IR26"),
                     alpha_presentation_cleaned_results_26 %>% mutate(freq = "alpha") %>% mutate(sub = "IR26"),
                     beta_presentation_cleaned_results_26 %>% mutate(freq = "beta") %>% mutate(sub = "IR26"),
                     gamma_presentation_cleaned_results_26 %>% mutate(freq = "gamma") %>% mutate(sub = "IR26"),
                     hfa_presentation_cleaned_results_26 %>% mutate(freq = "hfa") %>% mutate(sub = "IR26"),
                     delta_presentation_cleaned_results_16 %>% mutate(freq = "delta")  %>% mutate(sub = "IR16"),
                     theta_presentation_cleaned_results_16 %>% mutate(freq = "theta") %>% mutate(sub = "IR16"),
                     alpha_presentation_cleaned_results_16 %>% mutate(freq = "alpha") %>% mutate(sub = "IR16"),
                     beta_presentation_cleaned_results_16 %>% mutate(freq = "beta") %>% mutate(sub = "IR16"),
                     gamma_presentation_cleaned_results_16 %>% mutate(freq = "gamma") %>% mutate(sub = "IR16"),
                     hfa_presentation_cleaned_results_16 %>% mutate(freq = "hfa") %>% mutate(sub = "IR16"),
                     delta_presentation_cleaned_results_10 %>% mutate(freq = "delta") %>% mutate(sub = "IR10"),
                     theta_presentation_cleaned_results_10 %>% mutate(freq = "theta") %>% mutate(sub = "IR10"),
                     alpha_presentation_cleaned_results_10 %>% mutate(freq = "alpha") %>% mutate(sub = "IR10"),
                     beta_presentation_cleaned_results_10 %>% mutate(freq = "beta") %>% mutate(sub = "IR10"),
                     gamma_presentation_cleaned_results_10 %>% mutate(freq = "gamma") %>% mutate(sub = "IR10"),
                     hfa_presentation_cleaned_results_10 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR10"),
                     delta_presentation_cleaned_results_9 %>% mutate(freq = "delta")  %>% mutate(sub = "IR9"),
                     theta_presentation_cleaned_results_9 %>% mutate(freq = "theta")  %>% mutate(sub = "IR9"),
                     alpha_presentation_cleaned_results_9 %>% mutate(freq = "alpha")  %>% mutate(sub = "IR9"),
                     beta_presentation_cleaned_results_9 %>% mutate(freq = "beta")  %>% mutate(sub = "IR9"),
                     gamma_presentation_cleaned_results_9 %>% mutate(freq = "gamma")  %>% mutate(sub = "IR9"),
                     hfa_presentation_cleaned_results_9 %>% mutate(freq = "hfa")  %>% mutate(sub = "IR9"))

all_choice_results$epoch <- "choice"
all_presentation_results$epoch <- "presentation"

all_results <- rbind(all_choice_results, all_presentation_results)

all_results %>%
  select(freq, epoch, sub, electrode, perm_p) %>%
  distinct() %>%
  group_by(freq, epoch, sub) %>%
  mutate(total_elecs = n()) %>%
  filter(perm_p < .01) %>%
  group_by(freq, epoch, sub, total_elecs) %>%
  summarise(n = n()) %>%
  mutate(percent_active = n/total_elecs) %>%
  select(-total_elecs) %>%
  kable() %>%
  kable_styling()
  
  
all_results %>%
  gather(key = "elec_num", value = "elec_name", first_region, second_region) %>%
  mutate(ofc = if_else(grepl("ofc", elec_name, ignore.case = T), 1,
                             if_else(grepl("orbit", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(frontopolar = if_else(grepl("polar", elec_name, ignore.case = T), 1,
                             if_else(grepl("frontopolar", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(insula = if_else(grepl("insula", elec_name, ignore.case = T), 1,
                           if_else(grepl("insular", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(mfg = if_else(grepl("mfg", elec_name, ignore.case = T), 1,
                     if_else(grepl("medial frontal", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(temporal_gyr = if_else(grepl("[i|s|m]tg", elec_name, ignore.case = T), 1,
                     if_else(grepl("temporal gyrus", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(cingulate = if_else(grepl("CC", elec_name, ignore.case = T), 1,
                           if_else(grepl("cing", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(sts = if_else(grepl("sts", elec_name, ignore.case = T), 1,
                 if_else(grepl("superior temporal", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(hipp_formation = if_else(grepl("hinal", elec_name, ignore.case = T), 1,
                           if_else(grepl("ca1", elec_name, ignore.case = T), 1, 0))) %>%
  mutate(amyg = if_else(grepl("amyg", elec_name, ignore.case = T), 1,
                           if_else(grepl("ca1", elec_name, ignore.case = T), 1, 0))) %>%
  gather(key = "region", value = "exists",  ofc, frontopolar, insula, mfg, cingulate, sts, hipp_formation, amyg, temporal_gyr) %>%
  filter(exists == 1) %>%
  select(freq, epoch, sub, electrode, region, perm_p) %>%
  distinct() %>%
  group_by(freq, epoch, region) %>%
  mutate(total_elecs = n()) %>%
  filter(perm_p < .01) %>%
  group_by(freq, epoch, region, total_elecs) %>%
  summarise(n = n()) %>%
  mutate(percent_active = n/total_elecs) %>%
  select(-total_elecs) %>%
  arrange(desc(percent_active)) %>%
  kable() %>%
  kable_styling()

```


